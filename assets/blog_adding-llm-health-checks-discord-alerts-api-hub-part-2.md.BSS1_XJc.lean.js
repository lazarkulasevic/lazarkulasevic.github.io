import{_ as i,c as a,a0 as e,o as t}from"./chunks/framework.NuXjtxA0.js";const c=JSON.parse('{"title":"Adding LLM Health Checks and Discord Alerts to the API Hub (Part 2)","description":"A daily LLM health check with Discord alerting for the shared serverless API hubâ€”zero token usage, freemium, CRON_SECRET auth, all on Vercel. Covers implementation and Vercel Cron.","frontmatter":{"type":"article","title":"Adding LLM Health Checks and Discord Alerts to the API Hub (Part 2)","image":"/blog/adding-llm-health-checks-and-discord-alerts-to-the-api-hub/featured.jpg","description":"A daily LLM health check with Discord alerting for the shared serverless API hubâ€”zero token usage, freemium, CRON_SECRET auth, all on Vercel. Covers implementation and Vercel Cron.","publishedOn":"30 January 2026","updatedOn":null,"tags":["AI","Serverless","Monitoring"],"head":[["meta",{"property":"og:title","content":"Adding LLM Health Checks and Discord Alerts to the API Hub (Part 2)"}],["meta",{"property":"og:description","content":"Daily LLM health check with Discord alerting for the API hubâ€”models.list() only, no tokens, Vercel Cron + webhook."}],["meta",{"property":"keywords","content":"llm health check, discord webhook, vercel cron, groq api, serverless monitoring, api hub"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:url","content":"https://deployandpray.com/blog/adding-llm-health-checks-discord-alerts-api-hub-part-2"}],["meta",{"property":"og:image","content":"https://deployandpray.com/blog/adding-llm-health-checks-and-discord-alerts-to-the-api-hub/featured.jpg"}],["meta",{"name":"twitter:title","content":"Adding LLM Health Checks and Discord Alerts to the API Hub (Part 2)"}],["meta",{"name":"twitter:description","content":"Daily LLM health check with Discord alerting for the API hubâ€”models.list() only, no tokens, Vercel Cron + webhook."}],["meta",{"property":"og:url","content":"https://deployandpray.com/blog/adding-llm-health-checks-discord-alerts-api-hub-part-2"}],["meta",{"name":"twitter:image","content":"https://deployandpray.com/blog/adding-llm-health-checks-and-discord-alerts-to-the-api-hub/featured.jpg"}]]},"headers":[],"relativePath":"blog/adding-llm-health-checks-discord-alerts-api-hub-part-2.md","filePath":"blog/adding-llm-health-checks-discord-alerts-api-hub-part-2.md"}'),n={name:"blog/adding-llm-health-checks-discord-alerts-api-hub-part-2.md"};function l(h,s,r,o,p,k){return t(),a("div",null,s[0]||(s[0]=[e(`<p>In <a href="/blog/building-a-shared-serverless-api-hub-for-ai-chat">Part 1</a>, I walked through building a shared serverless API hub that powers the AI chat on deployandpray.comâ€”security layers, rate limiting, Prompt Guard, and the knowledge base. One thing I called out in &quot;What I&#39;d improve&quot; was <strong>monitoring</strong>. If Groq goes down or a model disappears, I don&#39;t want to find out from a broken chat; I want an alert so I can switch to a backup or fix config. So I added a simple, freemium health check that runs on Vercel and pings Discord when something&#39;s wrong.</p><p>This post covers that implementation: a daily LLM health check with Discord alerting, all running on the same Vercel project.</p><h2 id="why-bother-monitoring-the-llm" tabindex="-1">Why Bother Monitoring the LLM? <a class="header-anchor" href="#why-bother-monitoring-the-llm" aria-label="Permalink to &quot;Why Bother Monitoring the LLM?&quot;">â€‹</a></h2><p>The chat API depends on two Groq models:</p><ul><li><strong><code>llama-3.1-8b-instant</code></strong> â€” main chat model</li><li><strong><code>meta-llama/llama-prompt-guard-2-86m</code></strong> â€” prompt injection guard</li></ul><p>If either is unavailable (provider outage, model deprecated, quota/keys misconfigured), the chat breaks. I don&#39;t have a 24/7 ops team, so I wanted:</p><ol><li><strong>Proactive alerts</strong> â€” know when something&#39;s wrong before users hit errors</li><li><strong>Minimal cost</strong> â€” ideally free</li><li><strong>Same infra</strong> â€” no extra services if possible; Vercel + cron + webhook is enough</li></ol><p>A daily cron that checks &quot;are my models still there?&quot; and posts to Discord fit that. No tokens spent (we use the models list API), no new SaaS, and I get a message I can&#39;t miss.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">â€‹</a></h2><p>The flow is straightforward:</p><ul><li><strong>Vercel Cron</strong> triggers the health endpoint once per day.</li><li><strong>Health endpoint</strong> calls Groq&#39;s <code>models.list()</code>, checks that both required models appear, and returns JSON.</li><li><strong>On failure</strong> (missing model or API error), the same handler sends a Discord webhook with a short embed (title, error, suggested action).</li></ul><p>No separate worker or external monitoring service; everything lives in the same repo and deployment.</p><h2 id="implementation" tabindex="-1">Implementation <a class="header-anchor" href="#implementation" aria-label="Permalink to &quot;Implementation&quot;">â€‹</a></h2><h3 id="_1-health-check-endpoint" tabindex="-1">1. Health check endpoint <a class="header-anchor" href="#_1-health-check-endpoint" aria-label="Permalink to &quot;1. Health check endpoint&quot;">â€‹</a></h3><p>The handler lives at <code>api/health/llm.ts</code>. It:</p><ul><li>Accepts only <code>GET</code> (Vercel Cron uses GET).</li><li><strong>Requires <code>CRON_SECRET</code></strong> â€” rejects requests without a valid <code>Authorization: Bearer &lt;secret&gt;</code> header (returns 401).</li><li>Reads <code>GROQ_API_KEY</code> and <code>DISCORD_WEBHOOK_URL</code> from env.</li><li>Calls <code>groq.models.list()</code> â€” no chat completions, so <strong>zero token usage</strong>.</li><li>Verifies that both required model IDs are in the list.</li><li>Returns <strong>200</strong> with a small JSON body when healthy, <strong>503</strong> when not.</li><li>On unhealthy, calls the Discord webhook with an embed (red, title + description + fields).</li></ul><p>Core check logic:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> REQUIRED_MODELS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;llama-3.1-8b-instant&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;meta-llama/llama-prompt-guard-2-86m&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> groq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Groq</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ apiKey })</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> modelsResponse</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> groq.models.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> availableModelIds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> modelsResponse.data.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> model.id)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missingModels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> REQUIRED_MODELS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">availableModelIds.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (missingModels.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Send Discord alert, return 503 with error details</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>So we&#39;re only checking &quot;are these models still listed?&quot; â€” no inference, no extra cost.</p><h3 id="_2-discord-webhook" tabindex="-1">2. Discord webhook <a class="header-anchor" href="#_2-discord-webhook" aria-label="Permalink to &quot;2. Discord webhook&quot;">â€‹</a></h3><p>Discord&#39;s Incoming Webhooks accept a JSON body with an <code>embeds</code> array. I send one embed per alert:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(webhookUrl, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    embeds: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ðŸš¨ LLM Health Check Failed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        description: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;One or more required models are unavailable on Groq.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        color: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0xff0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// red</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        timestamp: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toISOString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        fields: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Missing Models&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value: missingModels.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;, &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), inline: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Action Required&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            value: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Check Groq status or swap to replacement models.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            inline: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Same pattern is used for API errors (e.g. bad key, timeout): one embed with title, description, and an &quot;Action required&quot; line. I don&#39;t await or retry the webhook; if Discord fails, we still return 503 and log. Alerting is best-effort so the health check itself stays simple.</p><h3 id="_3-vercel-cron" tabindex="-1">3. Vercel Cron <a class="header-anchor" href="#_3-vercel-cron" aria-label="Permalink to &quot;3. Vercel Cron&quot;">â€‹</a></h3><p>In <code>vercel.json</code>:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;crons&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/health/llm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;schedule&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0 9 * * *&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>0 9 * * *</code> is daily at 09:00 UTC. Vercel&#39;s cron hits the path with a GET request.</p><p><strong>Important:</strong> You must set <code>CRON_SECRET</code> in your Vercel environment variables. Vercel Cron automatically includes the <code>Authorization: Bearer &lt;CRON_SECRET&gt;</code> header when calling the endpoint, so authenticated requests work out of the box.</p><h3 id="_4-response-shape" tabindex="-1">4. Response shape <a class="header-anchor" href="#_4-response-shape" aria-label="Permalink to &quot;4. Response shape&quot;">â€‹</a></h3><p>Callers (and future tooling) get a consistent JSON body.</p><p><strong>Unauthorized (401):</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Unauthorized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;checkedAt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2026-01-30T09:00:00.000Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Healthy (200):</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;healthy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;models&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;llama-3.1-8b-instant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;available&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;meta-llama/llama-prompt-guard-2-86m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;available&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;checkedAt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2026-01-30T09:00:00.000Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Unhealthy (503):</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unhealthy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Models unavailable: llama-3.1-8b-instant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;models&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;llama-3.1-8b-instant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unavailable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;meta-llama/llama-prompt-guard-2-86m&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;available&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;checkedAt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2026-01-30T09:00:00.000Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>That makes it easy to add an external uptime check later (e.g. &quot;GET this URL and assert status is healthy&quot;) or to extend the endpoint with more checks.</p><h2 id="cost" tabindex="-1">Cost <a class="header-anchor" href="#cost" aria-label="Permalink to &quot;Cost&quot;">â€‹</a></h2><ul><li><strong>Vercel</strong> â€” Cron is included on the Hobby plan (one cron per day is enough for this).</li><li><strong>Groq</strong> â€” <code>models.list()</code> doesn&#39;t use tokens.</li><li><strong>Discord</strong> â€” Webhooks are free.</li></ul><p>So the whole thing is freemium as intended.</p><h2 id="testing-the-integration" tabindex="-1">Testing the integration <a class="header-anchor" href="#testing-the-integration" aria-label="Permalink to &quot;Testing the integration&quot;">â€‹</a></h2><p>To confirm Discord receives alerts, I temporarily added a fake model ID to <code>REQUIRED_MODELS</code>, ran <code>vercel dev</code>, and did:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$CRON_SECRET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000/api/health/llm</span></span></code></pre></div><p>Make sure <code>CRON_SECRET</code> is set in your <code>.env.local</code> for local testing. The handler reported &quot;unhealthy&quot; and sent the Discord message. Removed the fake model and reverted. Worth doing once so you know the channel and embed look right.</p><p>You can also trigger the cron manually from the Vercel dashboard (Settings â†’ Crons â†’ Run) â€” Vercel automatically includes the auth header.</p><h2 id="security-cron-secret" tabindex="-1">Security: CRON_SECRET <a class="header-anchor" href="#security-cron-secret" aria-label="Permalink to &quot;Security: CRON_SECRET&quot;">â€‹</a></h2><p>The endpoint requires authentication to prevent unauthorized access. Without a valid <code>Authorization: Bearer &lt;CRON_SECRET&gt;</code> header, requests are rejected with 401.</p><p>To set it up:</p><ol><li>Generate a secure secret: <code>openssl rand -hex 32</code></li><li>Add <code>CRON_SECRET</code> to your Vercel environment variables (Settings â†’ Environment Variables)</li><li>For local development, add it to <code>.env.local</code></li></ol><p>Vercel Cron automatically includes the auth header when calling the endpoint, so no extra configuration is needed once the env var is set. This keeps the health check private â€” only Vercel Cron (or you with the secret) can trigger it.</p><h2 id="wrapping-up" tabindex="-1">Wrapping up <a class="header-anchor" href="#wrapping-up" aria-label="Permalink to &quot;Wrapping up&quot;">â€‹</a></h2><ul><li><strong>Single codebase</strong> â€” health check lives next to the chat API in the same repo.</li><li><strong>Private endpoint</strong> â€” <code>CRON_SECRET</code> ensures only Vercel Cron (or authorized callers) can trigger it.</li><li><strong>Lightweight check</strong> â€” <code>models.list()</code> only; no inference, no token cost.</li><li><strong>Clear signal</strong> â€” one Discord message per failure with &quot;what&#39;s wrong&quot; and &quot;what to do.&quot;</li><li><strong>Same platform</strong> â€” Vercel cron + serverless function + env vars, no new vendors.</li></ul><p>If you&#39;re running a small API hub like this, a daily &quot;are my LLMs still there?&quot; check plus a Discord webhook is a simple way to get alerted before users do. Next improvements I&#39;m considering: response-time checks (actual completion with a tiny prompt) and a simple status page that hits this endpointâ€”but for &quot;is the provider and config still okay?&quot;, this is enough for now.</p>`,53)]))}const E=i(n,[["render",l]]);export{c as __pageData,E as default};
